!function(t,e){window.touchSlider=function(n){function i(t){w.removeClass(n.currentClass).eq(t).addClass(n.currentClass)}function o(t,n){var i=l.current;i!==t&&(t=t!==e?t:i+1,T.to(t,{complete:n}))}function r(t){T.to(l.current+1,{dirX:1,complete:t})}function a(t){T.to(l.current-1,{dirX:-1,complete:t})}function u(){C&&s()}function s(){return C=!0,y||(clearTimeout(q),q=setTimeout(function(){!T.moving&&!y&&r()},n.delay)),n.container}function c(){return clearTimeout(q),C=!1,n.container}n=n||{};var h=n.namespace||"touchslider",f=t(n.container);if(1!==f.length)return void f.each(function(){touchSlider({container:this})});n=t.extend({autoplay:!1,delay:3e3,margin:5,viewport:"."+h+"-viewport",prev:"."+h+"-prev",next:"."+h+"-next",pagination:"."+h+"-nav-item",currentClass:h+"-nav-item-current",duration:350,mouseTouch:!0},n);var l={current:0,step:o,next:r,prev:a,start:s,stop:c},m="ontouchstart"in window&&"WebKitCSSMatrix"in window,p="touchstart",g="touchmove",d="touchend",v=t(n.viewport,f),b=n.scroller?t(n.scroller,f):v.children(),M=b.children(),w=t(n.pagination,f);if("absolute"!==b.css("position")){var x=v.height();v.css({height:x,position:"relative"}),b.css({position:"absolute",left:0,height:x,width:1e5})}m||(p="mousedown",g="mousemove",d="mouseup"),M.css("position","absolute");var S=m?function(t,n,i){if(n===e)return new WebKitCSSMatrix(getComputedStyle(t.jquery?t[0]:t).webkitTransform).e;t.css({webkitTransitionDuration:i?i+"ms":"0",webkitTransform:function(t){return"translate3d("+("number"==typeof n?n:n.call(this,t))+"px,0,0)"}})}:function(t,n){if(n===e)return parseInt((t.jquery?t[0]:t).style.left,10);t.css("left",n)};m&&M.css({webkitTransitionProperty:"-webkit-transform",webkitTransitionTimingFunction:"cubic-bezier(0,0,0.25,1)"}),S(M.not(M[0]),1e4),S(M.eq(0),0);var T=function(){var o=[0],r=[0],a=t.noop;return{moving:!1,init:function(){b.bind("webkitTransitionEnd",function(){a()})},to:function(s,c){c=c||{},s>=M.length?s=0:s<0&&(s=M.length-1);var h=n.duration,f=M.eq(s),p=t.inArray(s,o),g=0;if(b.stop(),T.moving=!0,clearTimeout(q),p!==-1)g=r[p];else{var d,v=M.index(f);if(p=e,c.dirX===-1)r.unshift(0),o.unshift(v);else if(1===c.dirX)r.push(0),o.push(v);else{for(d=o.length-1;d>=0;d--)if(o[d]<v){r.splice(d+1,0,0),o.splice(d+1,0,v),p=0;break}p===e&&(r.unshift(r),o.unshift(v))}if(0===(p=t.inArray(v,o)))g=r[1]-(f.outerWidth()+n.margin),S(f,g),r[p]=g;else if(p===o.length-1)g=r[p-1]+M.eq(o[p-1]).outerWidth()+n.margin,S(f,g),r[p]=g;else{var w=f.outerWidth();f.css("opacity",0),g=r[p+1]-Math.round((w+n.margin)/2),r[p]=g,S(f,g);var x=g,k=o.length;for(d=p-1;d>=0;d--)x-=M.eq(o[d]).outerWidth()+n.margin,r[d]=x;var y=g;for(d=p+1;d<k;d++)y+=M.eq(o[d]).outerWidth()+n.margin,r[d]=y;for(d=0;d<k;d++)M.eq(o[d]).animate({left:r[d]},{duration:h,queue:!1,complete:function(){f.is(this)&&f.animate({opacity:1},h)}})}}c.pxInMs&&(h=Math.min(Math.max(Math.round(Math.abs(S(b))/c.pxInMs),100),h)),a=function(){S(M.not(f),-1e4),o=[M.index(f)],r=[g],c.complete&&c.complete(),T.moving=!1,u()},m?S(b,-g,h):b.animate({left:-g},{duration:h,queue:!1,complete:a}),l.current=s,i(s)},stop:function(){m?S(b,S(b)):b.stop()},moveStart:function(t){T.moving=!0,clearTimeout(q),b.stop(),T.startPageX=t.pageX;var e,n=S(b);T.leftCount=n,0===o[0]?r[0]+n>0&&(T.leftCount=n+3*(r[0]+n)):o[o.length-1]===M.length-1&&(e=r[o.length-1]+n)<0&&(T.leftCount=n+3*e)},move:function(t,e){var i,a,u,s=t.pageX-e,c=S(b),h=(M.eq(o[0]),o.length-1),f=M.eq(o[h]);if(T.leftCount+=s,s>0)for(;0!==o[0]&&c+r[0]+s>n.margin;)i=M.eq(o[0]-1),a=r[0]-i.outerWidth()-n.margin,S(i,a),r.unshift(a),o.unshift(o[0]-1),h++,i;if((s>0&&c+r[0]+s>0||s<0&&c+r[0]>0)&&0===o[0]&&(u=Math.min(Math.round((T.leftCount+r[0])/4),v.innerWidth()/2),s=u-(c+r[0])),s<0)for(;!f.is(M.last())&&c+r[h]+s+f.outerWidth()+n.margin<v.innerWidth();)i=M.eq(o[h]+1),a=r[h]+f.outerWidth()+n.margin,S(i,a),r.push(a),o.push(o[h++]+1),f=i;(s>0&&c+r[h]<0||s<0&&c+r[h]+s<0)&&f.is(M.last())&&(u=Math.max(Math.round((T.leftCount+r[h])/4),-v.innerWidth()/2),s=u-(c+r[h])),S(b,c+s)},moveEnd:function(t,e,n,i,a,u){var s,c=o.length,h=S(b),f=c-1;if(r[0]+h>0)f=0;else if(!(r[o.length-1]+h<0)){s={pxInMs:e};var l,m,p=c-1,g=v.innerWidth();for(l=0;l<c-1;l++)if((m=r[l]+M.eq(o[l]).outerWidth()+h)>0&&m>g-(r[l+1]+h)){p=l;break}if(k)f=p;else{var d=c-1,w=Math.round(b.offset().left);for(l=0;l<c;l++)if(r[l]+w>t.pageX){d=l-1;break}f=p,p===d&&t.timeStamp-i<1e3&&a+u>.05*Math.sqrt(Math.pow(v.height(),2)+Math.pow(g,2))&&(f=Math.max(0,Math.min(c-1,f+n)))}}f=o[f],T.to(f,s)}}}();if(T.init(),m){var k=!1;b.bind("webkitTransitionStart",function(){k=!0}),b.bind("webkitTransitionEnd",function(){k=!1})}var q,y=!1,C=!1;v.hover(function(){clearTimeout(q),y=!0},function(){y=!1,u()}),w.click(function(){o(w.index(this))}),t(n.prev,f).click(function(){a()}),t(n.next,f).click(function(){r()}),n.mouseTouch&&function(){var e,n,i,o,r,a,u,s,c,f,l,M,w,x=t(document),S=!1,q=function(t){if(!(t.which>1)){if(S&&x.triggerHandler(d+"."+h),S=!0,n=!1,e=t.timeStamp,u=M=0,i=[0,0,0,e],t.originalEvent.touches)return void x.one(p,y);t.preventDefault(),r=a=t.pageX,f=l=t.pageY,c=b[0].offsetLeft,o=[0,0,0,r],x.bind(g,C),x.one(d+"."+h,W),T.moveStart(t)}},y=function(t){1===t.originalEvent.touches.length&&(r=a=t.pageX=t.originalEvent.touches[0].pageX,f=l=t.pageY=t.originalEvent.touches[0].pageY,s=w=0,c=new WebKitCSSMatrix(window.getComputedStyle(b[0]).webkitTransform).e,o=[0,0,0,r],x.bind(g,C),x.one(d,W),T.moveStart(t))},C=function(e){var r,c;if(e.originalEvent.touches&&m){if(1!==e.originalEvent.touches.length)return;if(r=e.pageX=e.originalEvent.touches[0].pageX,c=e.pageY=e.originalEvent.touches[0].pageY,s+=Math.abs(r-a),w+=Math.abs(c-l),Math.abs(s-w)>50){var h=s;s=Math.min(100,Math.max(0,s-w)),w=Math.min(100,Math.max(0,w-h))}if(r===a)return;n||(s>w?(e.preventDefault(),n=!0):W(e))}else{if(r=e.pageX,c=e.pageY,r===a)return;t.browser.msie&&e.preventDefault()}u+=Math.abs(r-a),M+=Math.abs(c-l),i.shift(),i.push(e.timeStamp),o.shift(),o.push(r),T.move(e,a),a=r,l=c},W=function(t){S=!1,t.originalEvent&&!t.originalEvent.touches||(t.pageX=a,t.pageY=l),x.unbind(g,C);for(var n=i.length,r=0,s=0;--n>0;)if(i[n-1]){var c=o[n]-o[n-1];r+=Math.abs(c)/(i[n]-i[n-1]),0!==c&&(s=c>0?-1:1)}r/=i.length,T.moveEnd(t,r,s,e,u,M),k=!1,u+M>4&&v.one("click",function(t){t.preventDefault()})};v.bind(p,q)}(),n.autoplay&&s(),f.data(h,l)},t.fn.touchSlider=function(t){return t=t||{},t.container=this,touchSlider(t),this}}(jQuery);